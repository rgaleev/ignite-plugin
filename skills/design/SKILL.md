---
name: design
description: Use when creating a visual design system for a project, generating design options from a PRD, refining tokens.css, or applying design tokens to mockups
---

# Design System

## Overview

Create a visual design system through a 3-stage process: generate style options → refine to tokens → apply to mockups. Supports `--refine` and `--apply` subcommands.

## Preconditions

| Command | Check | If missing |
|---------|-------|-----------|
| `/ignite:design` | `PRD.md` exists | "No PRD.md found. Run `/ignite:prd` first." |
| `/ignite:design --refine` | `docs/design/options/` has HTML files OR user provides verbal direction | If no files AND no verbal input: ask via AskUserQuestion which option they prefer |
| `/ignite:design --apply` | `docs/design/tokens.css` exists AND `mockups/*.html` exist | "No design tokens. Run `/ignite:design` then `/ignite:design --refine` first." |

## Stage 1: Generate Options (`/ignite:design`)

### Step 1: Analyze Context

Read `PRD.md` to understand:
- Product type (tool, dashboard, creative app, etc.)
- Target users (professional, casual, technical)
- Technical stack (informs what's feasible)
- Mood/tone (from problem statement, user descriptions)

If mockups exist, also review them for current layout patterns.

### Step 2: Propose Style Directions

Present 3 distinct design directions using AskUserQuestion. Each direction should be genuinely different — not just color swaps:

```
Which design direction appeals to you?

A) "Clean Professional" — Minimal, lots of white space, Inter font, blue/gray palette.
   Think: Linear, Notion. Good for tool-focused products.

B) "Warm Creative" — Soft rounded shapes, warm palette (amber/coral), friendly typography.
   Think: Figma, Canva. Good for creative workflows.

C) "Dark Technical" — Dark surfaces, high-contrast accents, monospace touches.
   Think: VS Code, GitHub. Good for developer/power-user tools.
```

### Step 3: Generate Option Pages

Create `docs/design/options/` directory. For each option, fill in the `design-reference-template.html` with specific values:

1. Read the template from plugin's `skills/design/design-reference-template.html`
2. Replace all `{{PLACEHOLDER}}` values with the option's specific design tokens
3. Generate color swatches HTML for `{{COLOR_SWATCHES}}`
4. Generate sample cards HTML for `{{SAMPLE_CARDS}}` using project-specific content
5. Save as `docs/design/options/option-a.html`, `option-b.html`, `option-c.html`
6. Add feedback overlay to each option page

### Step 4: Serve Options

Switch feedback server to serve design options:
1. Kill existing server (if running)
2. Start: `node feedback-server.js docs/design/options/ 3000`
3. Create `docs/design/options/index.html` linking to all three options

Report:
```
3 design options generated!

Review at: http://localhost:3000
- option-a.html — Clean Professional
- option-b.html — Warm Creative
- option-c.html — Dark Technical

Annotate what you like/dislike on each option, then run:
  /ignite:design --refine
```

## Stage 2: Refine to Tokens (`/ignite:design --refine`)

### Step 1: Gather Direction

**If feedback JSON files exist** in `docs/design/options/`:
- Read all feedback files
- Synthesize: which option is preferred, what modifications are requested
- Present summary: "Based on your annotations, you liked A's colors, B's typography, and wanted rounder buttons. Generating design system..."

**If no feedback files exist:**
- Ask via AskUserQuestion: "Which design direction do you prefer?" with the 3 options
- Follow-up: "Any modifications? (e.g., 'darker backgrounds', 'rounder buttons', 'use serif for headings')"

### Step 2: Generate tokens.css

Create `docs/design/tokens.css` with all CSS custom properties:

```css
/* Design System Tokens — [Project Name]
   Generated by /ignite:design --refine
   Direction: [selected option + modifications] */

:root {
  /* Colors — Primary */
  --color-primary: #value;
  --color-primary-hover: #value;
  --color-primary-light: #value;

  /* Colors — Secondary & Accent */
  --color-secondary: #value;
  --color-accent: #value;

  /* Colors — Surfaces */
  --color-surface: #value;
  --color-surface-alt: #value;
  --color-background: #value;
  --color-border: #value;

  /* Colors — Text */
  --color-text: #value;
  --color-text-muted: #value;
  --color-text-inverse: #value;

  /* Colors — Feedback */
  --color-success: #value;
  --color-warning: #value;
  --color-error: #value;

  /* Typography */
  --font-heading: 'Font Name', system-ui, sans-serif;
  --font-body: 'Font Name', system-ui, sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', monospace;

  /* Spacing & Shapes */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  /* Shadows */
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
  --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
  --shadow-lg: 0 8px 30px rgba(0,0,0,0.15);

  /* Transitions */
  --transition-fast: 150ms ease;
  --transition-normal: 250ms ease;
}
```

### Step 3: Generate Reference Page

Create `docs/design/reference.html` — a comprehensive design reference showing ALL tokens applied to real components. This is NOT from the template — it's generated fresh with the final merged values. Include:
- Full color palette with hex values
- Typography scale (h1 through body, code)
- Button variants (primary, secondary, ghost, danger)
- Card components
- Form elements (input, select, checkbox, radio)
- Table styling
- Status badges
- Navigation patterns
- Spacing scale visualization

### Step 4: Generate Design Spec

Create `docs/design/design-system.md` — human-readable design specification:
```markdown
# Design System — [Project Name]

## Direction
[Description of chosen style direction and modifications]

## Colors
| Token | Value | Usage |
|-------|-------|-------|
| --color-primary | #3b82f6 | Primary actions, links, active states |
| ... | ... | ... |

## Typography
| Role | Font | Weight | Size |
|------|------|--------|------|
| Heading | Inter | 700 | 24-32px |
| Body | Inter | 400 | 14-16px |
| Mono | JetBrains Mono | 400 | 13px |

## Shapes
| Token | Value | Usage |
|-------|-------|-------|
| --radius-md | 8px | Buttons, inputs, small cards |
| ... | ... | ... |

## Usage Guidelines
- Use primary color for main CTA buttons and active navigation
- Use surface-alt for alternating table rows and card backgrounds
- Use shadow-sm for cards, shadow-md for modals/dropdowns
```

Present the full token list: "Here's your design system. Approve?"

## Stage 3: Apply to Mockups (`/ignite:design --apply`)

### Step 1: Pre-flight Checks

1. Read `docs/design/tokens.css`
2. List all mockup HTML files in `mockups/`
3. Check for unresolved feedback:
   - Read each `.feedback.json` in `mockups/`
   - If any have open comments → warn:
     ```
     ⚠️ upload.html has 3 open comments. Applying design will reset annotation positions.
     Run /ignite:review first?
     ```
   - AskUserQuestion: "Review first" or "Proceed anyway"

### Step 2: Backup Feedback

For each mockup with existing `.feedback.json`:
- Rename to `.feedback.v{N}.json` (where N = current version number)
- Create fresh empty feedback structure

### Step 3: Reskin Mockups

For each mockup HTML file:
1. **Parse** the current `:root { ... }` CSS custom properties block
2. **Replace** with values from `tokens.css`
3. **Add** Google Fonts `<link>` if design uses custom fonts (add before `</head>`)
4. **Preserve** all Tailwind layout classes — only CSS custom properties change
5. **Do NOT** modify HTML structure or content

The reskinning targets ONLY the `<style>` block containing `:root`. Everything else stays untouched.

### Step 4: Restart Server & Report

1. Kill existing server
2. Restart: `node feedback-server.js mockups/ 3000`
3. Report:
```
Design applied to [N] mockups!

Review at: http://localhost:3000

Design tokens from: docs/design/tokens.css
Reference page: docs/design/reference.html

The mockups now use your design system. Annotate any visual issues,
then run /ignite:review for final adjustments.
```

## Important Rules

- **3 genuinely distinct options** — not just color variations
- **Google Fonts only** — no paid or system-specific fonts
- **tokens.css is the single source of truth** — reference page and mockups both derive from it
- **--apply never touches HTML structure** — only CSS custom properties in the style block
- **Backup feedback before reskinning** — old annotations preserved as .v{N}.json
